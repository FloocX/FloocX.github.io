<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>flareon11 writeup | Flooc</title><meta name="author" content="Flooc"><meta name="copyright" content="Flooc"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="flaren-on11_re_by_Flooc1-frog123456cipher &#x3D; &quot;\xa5\xb7\xbe\xb1\xbd\xbf\xb7\x8d\xa6\xbd\x8d\xe3\xe3\x92\xb4\xbe\xb3\xa0\xb7\xff\xbd\xbc\xfc\xb1\xbd\xbf&quot;for i in range(1000):    tmp &#x3D; (&quot;&amp;q">
<meta property="og:type" content="article">
<meta property="og:title" content="flareon11 writeup">
<meta property="og:url" content="http://example.com/2025/02/24/flare-on11_re_by_Flooc/index.html">
<meta property="og:site_name" content="Flooc">
<meta property="og:description" content="flaren-on11_re_by_Flooc1-frog123456cipher &#x3D; &quot;\xa5\xb7\xbe\xb1\xbd\xbf\xb7\x8d\xa6\xbd\x8d\xe3\xe3\x92\xb4\xbe\xb3\xa0\xb7\xff\xbd\xbc\xfc\xb1\xbd\xbf&quot;for i in range(1000):    tmp &#x3D; (&quot;&amp;q">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/avatar.jpg">
<meta property="article:published_time" content="2025-02-23T23:53:00.000Z">
<meta property="article:modified_time" content="2025-02-24T03:06:48.508Z">
<meta property="article:author" content="Flooc">
<meta property="article:tag" content="reverse">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="flareon">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/02/24/flare-on11_re_by_Flooc/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'flareon11 writeup',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/background.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/favicon.ico" alt="Logo"><span class="site-name">Flooc</span></a><a class="nav-page-title" href="/"><span class="site-name">flareon11 writeup</span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">flareon11 writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-02-23T23:53:00.000Z" title="发表于 2025-02-24 07:53:00">2025-02-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-02-24T03:06:48.508Z" title="更新于 2025-02-24 11:06:48">2025-02-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>10分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="flaren-on11-re-by-Flooc"><a href="#flaren-on11-re-by-Flooc" class="headerlink" title="flaren-on11_re_by_Flooc"></a>flaren-on11_re_by_Flooc</h1><h2 id="1-frog"><a href="#1-frog" class="headerlink" title="1-frog"></a>1-frog</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cipher = &quot;\xa5\xb7\xbe\xb1\xbd\xbf\xb7\x8d\xa6\xbd\x8d\xe3\xe3\x92\xb4\xbe\xb3\xa0\xb7\xff\xbd\xbc\xfc\xb1\xbd\xbf&quot;</span><br><span class="line"></span><br><span class="line">for i in range(1000):</span><br><span class="line">    tmp = (&quot;&quot;.join([chr(ord(x) ^ i) for x in cipher]))</span><br><span class="line">    if(&quot;flare&quot; in tmp):</span><br><span class="line">        print(tmp)</span><br></pre></td></tr></table></figure>

<h2 id="2-checksum"><a href="#2-checksum" class="headerlink" title="2-checksum"></a>2-checksum</h2><p>go逆向，使用xchacha20poly1305加密flag.jpg。</p>
<p>与正常的chacha20poly1305不用的是，x___是扩展版的，key仍是32字节，nonce变成24字节。</p>
<p>逻辑就是先整几个随机数，然后输入他们的和，check一下对不对，最后输入64长度的key，然后将它hex编码。。</p>
<p>先IDA反编译一下，看到这里nonce应该是取自32字节的key的前24字节</p>
<img src="/2025/02/24/flare-on11_re_by_Flooc/image-20241004140321978.png" class="" title="image-20241004140321978">

<p>然后就是将key异或后base64，这里IDA动调到的是错的，不知道为什么，可能是我前面nop了不改nop的东西？</p>
<p>有一个main_encryptedFlagData，有0x2c52c的字节的大小，应该就是加密后的flag了，用python脚本拿出来：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import idc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">address = 0x32DA80</span><br><span class="line">arr = []</span><br><span class="line">for i in range(0x2c52c):</span><br><span class="line">    arr.append(idc.get_wide_byte(address + i))</span><br><span class="line"></span><br><span class="line">with open(r&quot;C:\Users\86158\Downloads\ebcrypted_data.bin&quot;, &quot;wb&quot;) as p:</span><br><span class="line">    for i in arr:</span><br><span class="line">        p.write(i.to_bytes(1, byteorder=&#x27;little&#x27;))</span><br><span class="line">    </span><br><span class="line">print(&quot;ok&quot;)</span><br><span class="line">print(hex(len(arr)))</span><br></pre></td></tr></table></figure>

<img src="/2025/02/24/flare-on11_re_by_Flooc/image-20241004141010711.png" class="" title="image-20241004141010711">

<p>用ghidra和bn看到最后的Base64check的key密文数据</p>
<img src="/2025/02/24/flare-on11_re_by_Flooc/image-20241004140732895.png" class="" title="image-20241004140732895">拿出来解密一下得到key：

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">cipher = &quot;cQoFRQErX1YAVw1zVQdFUSxfAQNRBXUNAxBSe15QCVRVJ1pQEwd/WFBUAlElCFBFUnlaB1ULByRdBEFdfVtWVA==&quot;</span><br><span class="line"></span><br><span class="line">data = base64.b64decode(cipher)</span><br><span class="line"></span><br><span class="line">cipher1 = list(data)</span><br><span class="line"></span><br><span class="line">table = &quot;FlareOn2024&quot;</span><br><span class="line"></span><br><span class="line">for i in range(len(cipher1)):</span><br><span class="line">    print(chr(cipher1[i] ^ ord(table[i % len(table)])),end=&#x27;&#x27;)</span><br><span class="line">print()</span><br></pre></td></tr></table></figure>

<p>最后就是写个go脚本解密这个文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;io/ioutil&quot;</span><br><span class="line">	&quot;log&quot;</span><br><span class="line"></span><br><span class="line">	&quot;golang.org/x/crypto/chacha20poly1305&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	// 密钥和随机数</span><br><span class="line">	key := []byte&#123;0x7f, 0xd7, 0xdd, 0x1d, 0x0e, 0x95, 0x9f, 0x74, 0xc1, 0x33, 0xc1, 0x3a, 0xbb, 0x74, 0x0b, 0x9f,</span><br><span class="line">		0xaa, 0x61, 0xab, 0x06, 0xbd, 0x0e, 0xcd, 0x17, 0x76, 0x45, 0xe9, 0x3b, 0x1e, 0x38, 0x25, 0xdd&#125;</span><br><span class="line">	nonce := []byte&#123;0x7f, 0xd7, 0xdd, 0x1d, 0x0e, 0x95, 0x9f, 0x74, 0xc1, 0x33, 0xc1, 0x3a, 0xbb, 0x74, 0x0b, 0x9f,</span><br><span class="line">		0xaa, 0x61, 0xab, 0x06, 0xbd, 0x0e, 0xcd, 0x17&#125;</span><br><span class="line"></span><br><span class="line">	// 打开加密文件</span><br><span class="line">	ciphertext, err := ioutil.ReadFile(&quot;C:\\Users\\86158\\Downloads\\encrypted_data.bin&quot;)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		log.Fatal(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// 创建xChaCha20-Poly1305密钥</span><br><span class="line">	aead, err := chacha20poly1305.NewX(key)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		log.Fatal(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// 解密数据</span><br><span class="line">	plaintext, err := aead.Open(nil, nonce, ciphertext, nil)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		log.Fatal(&quot;解密失败: &quot;, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// 将解密后的内容写入文件</span><br><span class="line">	err = ioutil.WriteFile(&quot;decrypted_output.jpg&quot;, plaintext, 0644)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		log.Fatal(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(&quot;解密成功，内容已写入 decrypted_output.txt&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/2025/02/24/flare-on11_re_by_Flooc/image-20241004141032387.png" class="" title="image-20241004141032387">

<h2 id="3-aray"><a href="#3-aray" class="headerlink" title="3-aray"></a>3-aray</h2><p>手搓。。</p>
<p>先提取每个字节相关的condition，与crc32和md5的condition：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line">filesize_lines = []</span><br><span class="line"></span><br><span class="line">crc_lines = []</span><br><span class="line"></span><br><span class="line">md5_lines = []</span><br><span class="line"></span><br><span class="line">i_lines = [[] for c in range(85)]</span><br><span class="line">print(len(i_lines))</span><br><span class="line"></span><br><span class="line">with open(r&quot;C:\Users\86158\Downloads\flare\aray.yara&quot;, &quot;r&quot;) as p:</span><br><span class="line">    line = p.readline()</span><br><span class="line">    while line:</span><br><span class="line">        if &quot;filesize&quot; in line:</span><br><span class="line">            filesize_lines.append(line.replace(&quot; and&quot;, &quot;&quot;).strip())</span><br><span class="line">        if &quot;crc&quot; in line:</span><br><span class="line">            crc_lines.append(line.replace(&quot; and&quot;, &quot;&quot;).strip())</span><br><span class="line">        if &quot;md5&quot; in line:</span><br><span class="line">            md5_lines.append(line.replace(&quot; and&quot;, &quot;&quot;).strip())</span><br><span class="line">        for i in range(85):</span><br><span class="line">            if &quot;uint8(&#123;&#125;)&quot;.format(i) in line or &quot;uint32(&#123;&#125;)&quot;.format(i) in line:</span><br><span class="line">                i_lines[i].append(line.replace(&quot; and&quot;, &quot;&quot;).strip())</span><br><span class="line">        line = p.readline()</span><br><span class="line">for x in range(len(i_lines)):</span><br><span class="line">    print(i_lines[x])</span><br><span class="line">print()</span><br><span class="line">print(filesize_lines)</span><br><span class="line">print()</span><br><span class="line">print(md5_lines)</span><br><span class="line">print()</span><br><span class="line">print(crc_lines)</span><br></pre></td></tr></table></figure>

<p>先算hash相关的几个字节，采用爆破，大概模板是一样的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import zlib</span><br><span class="line"></span><br><span class="line">filesize = 85</span><br><span class="line"></span><br><span class="line"># 示例 bytes 对象</span><br><span class="line"># data = b&quot;hello&quot;</span><br><span class="line"># # # 计算 SHA-256</span><br><span class="line"># md5_hash = hashlib.md5(data).hexdigest()</span><br><span class="line"># print(md5_hash)</span><br><span class="line"></span><br><span class="line"># 计算 CRC32</span><br><span class="line">for a in range(3,156):</span><br><span class="line">    for b in range(6, 154):</span><br><span class="line">        data = a.to_bytes(1, byteorder=&quot;big&quot;) + b.to_bytes(1, byteorder=&quot;big&quot;)</span><br><span class="line">        # print(data)</span><br><span class="line">        if a ^ filesize != 88 and a ^ filesize != 30 and a &amp; 128 == 0:</span><br><span class="line">            if b ^ filesize != 22 and b ^ filesize != 223 and b &amp; 128 == 0:</span><br><span class="line">                md5_hash = hashlib.md5(data).hexdigest()</span><br><span class="line">                if md5_hash == &quot;f98ed07a4d5f50f7de1410d905f1477f&quot;:</span><br><span class="line">                    print(data)</span><br></pre></td></tr></table></figure>

<p>剩下的就是可以直接计算结果的，要注意uint32的计算完要反过来赋值，比如uint32(3)：</p>
<img src="/2025/02/24/flare-on11_re_by_Flooc/image-20241004213002906.png" class="" title="image-20241004213002906">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3 -&gt; 0x65</span><br><span class="line">4 -&gt; 0x20</span><br><span class="line">5 -&gt; 0x66</span><br><span class="line">6 -&gt; 0x6c</span><br></pre></td></tr></table></figure>

<p>最后搓出来下面这样的，我这里用字典表示。。：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">known_data = &#123;0: &quot;r&quot;,</span><br><span class="line">              1: &quot;u&quot;,</span><br><span class="line">              2: 108,</span><br><span class="line">              6:0x6c,</span><br><span class="line">              5:0x66,</span><br><span class="line">              4:0x20,</span><br><span class="line">              3:0x65,</span><br><span class="line">              7: 67,</span><br><span class="line">              8: &quot;r&quot;,</span><br><span class="line">              9: &quot;e&quot;,</span><br><span class="line">              13:0x7b,</span><br><span class="line">              12:0x20,</span><br><span class="line">              11:0x6e,</span><br><span class="line">              10:0x6f,</span><br><span class="line">              16: 116,</span><br><span class="line">              20:0x67,</span><br><span class="line">              19:0x6e,</span><br><span class="line">              18:0x69,</span><br><span class="line">              17:0x72,</span><br><span class="line">              21: 115,</span><br><span class="line">              25:0x66,</span><br><span class="line">              24:0x24,</span><br><span class="line">              23:0x20,</span><br><span class="line">              22:0x3a,</span><br><span class="line">              26: 34,</span><br><span class="line">              27: 60,</span><br><span class="line">              31:0x52,</span><br><span class="line">              30:0x31,</span><br><span class="line">              29:0x22,</span><br><span class="line">              28:0x20,</span><br><span class="line">              32: &quot;u&quot;,</span><br><span class="line">              33: &quot;l&quot;,</span><br><span class="line">              34: &quot;e&quot;,</span><br><span class="line">              35: &quot;A&quot;,</span><br><span class="line">              36: 68,</span><br><span class="line">              40:0x33,</span><br><span class="line">              39:0x4b,</span><br><span class="line">              38:0x79,</span><br><span class="line">              37:0x61,</span><br><span class="line">              44:0x4d,</span><br><span class="line">              43:0x24,</span><br><span class="line">              42:0x70,</span><br><span class="line">              41:0x33,</span><br><span class="line">              45: 97,</span><br><span class="line">              49:0x72,</span><br><span class="line">              48:0x34,</span><br><span class="line">              47:0x77,</span><br><span class="line">              46:0x6c,</span><br><span class="line">              50: &quot;3&quot;,</span><br><span class="line">              51: &quot;A&quot;,</span><br><span class="line">              55:0x40,</span><br><span class="line">              54:0x79,</span><br><span class="line">              53:0x34,</span><br><span class="line">              52:0x77,</span><br><span class="line">              58: 97,</span><br><span class="line">              62:0x6f,</span><br><span class="line">              61:0x2d,</span><br><span class="line">              60:0x65,</span><br><span class="line">              59:0x72,</span><br><span class="line">              63: &quot;n&quot;,</span><br><span class="line">              64: &quot;.&quot;,</span><br><span class="line">              65: 99,</span><br><span class="line">              69:0x20,</span><br><span class="line">              68:0x22,</span><br><span class="line">              67:0x6d,</span><br><span class="line">              66:0x6f,</span><br><span class="line">              73:0x64,</span><br><span class="line">              72:0x6e,</span><br><span class="line">              71:0x6f,</span><br><span class="line">              70:0x63,</span><br><span class="line">              74: 105,</span><br><span class="line">              75: 116,</span><br><span class="line">              76: &quot;i&quot;,</span><br><span class="line">              77: &quot;o&quot;,</span><br><span class="line">              78: &quot;n&quot;,</span><br><span class="line">              79: &quot;:&quot;,</span><br><span class="line">              83:0x20,</span><br><span class="line">              82:0x66,</span><br><span class="line">              81:0x24,</span><br><span class="line">              80:0x20,</span><br><span class="line">              84: 125&#125;</span><br><span class="line"># print(known_data.values())</span><br><span class="line">for key, value in known_data.items():</span><br><span class="line">    # print(value)</span><br><span class="line">    if isinstance(value, int):</span><br><span class="line">        # print(&quot;ok&quot;)</span><br><span class="line">        tmpvalue = chr(value)</span><br><span class="line">        known_data[key] = tmpvalue</span><br><span class="line">print(known_data)</span><br><span class="line"></span><br><span class="line">filesize = 85</span><br><span class="line">flag = dict(sorted(known_data.items()))</span><br><span class="line">print(flag)</span><br><span class="line">for key,value in flag.items():</span><br><span class="line">    print(value,end=&#x27;&#x27;)</span><br></pre></td></tr></table></figure>

<p>有的位置的字节是需要爆破的，但是看一眼，flag部分的字符是连续的，在最后补上flare-on.com就行了</p>
<img src="/2025/02/24/flare-on11_re_by_Flooc/image-20241004213401243.png" class="" title="image-20241004213401243">

<h2 id="4-Meme-Maker-3000"><a href="#4-Meme-Maker-3000" class="headerlink" title="4-Meme Maker 3000"></a>4-Meme Maker 3000</h2><p>js混淆，，解混淆一下  <a target="_blank" rel="noopener" href="https://js-deobfuscator.vercel.app/">https://js-deobfuscator.vercel.app</a><br>a0e是图片的base64编码，太多了删掉，逻辑很清晰了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">const a0c = [&quot;When you find a buffer overflow in legacy code&quot;, &quot;Reverse Engineer&quot;, &quot;When you decompile the obfuscated code and it makes perfect sense&quot;, &quot;Me after a week of reverse engineering&quot;, &quot;When your decompiler crashes&quot;, &quot;It&#x27;s not a bug, it&#x27;a a feature&quot;, &quot;Security &#x27;Expert&#x27;&quot;, &quot;AI&quot;, &quot;That&#x27;s great, but can you hack it?&quot;, &quot;When your code compiles for the first time&quot;, &quot;If it ain&#x27;t broke, break it&quot;, &quot;Reading someone else&#x27;s code&quot;, &quot;EDR&quot;, &quot;This is fine&quot;, &quot;FLARE On&quot;, &quot;It&#x27;s always DNS&quot;, &quot;strings.exe&quot;, &quot;Don&#x27;t click on that.&quot;, &quot;When you find the perfect 0-day exploit&quot;, &quot;Security through obscurity&quot;, &quot;Instant Coffee&quot;, &quot;H@x0r&quot;, &quot;Malware&quot;, &quot;$1,000,000&quot;, &quot;IDA Pro&quot;, &quot;Security Expert&quot;];</span><br><span class="line">const a0d = &#123;</span><br><span class="line">  doge1: [[&quot;75%&quot;, &quot;25%&quot;], [&quot;75%&quot;, &quot;82%&quot;]],</span><br><span class="line">  boy_friend0: [[&quot;75%&quot;, &quot;25%&quot;], [&quot;40%&quot;, &quot;60%&quot;], [&quot;70%&quot;, &quot;70%&quot;]],</span><br><span class="line">  draw: [[&quot;30%&quot;, &quot;30%&quot;]],</span><br><span class="line">  drake: [[&quot;10%&quot;, &quot;75%&quot;], [&quot;55%&quot;, &quot;75%&quot;]],</span><br><span class="line">  two_buttons: [[&quot;10%&quot;, &quot;15%&quot;], [&quot;2%&quot;, &quot;60%&quot;]],</span><br><span class="line">  success: [[&quot;75%&quot;, &quot;50%&quot;]],</span><br><span class="line">  disaster: [[&quot;5%&quot;, &quot;50%&quot;]],</span><br><span class="line">  aliens: [[&quot;5%&quot;, &quot;50%&quot;]]</span><br><span class="line">&#125;;</span><br><span class="line">const a0e = &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line">function a0f() &#123;</span><br><span class="line">  document.getElementById(&quot;caption1&quot;).hidden = true;</span><br><span class="line">  document.getElementById(&quot;caption2&quot;).hidden = true;</span><br><span class="line">  document.getElementById(&quot;caption3&quot;).hidden = true;</span><br><span class="line">  const a = document.getElementById(&quot;meme-template&quot;);</span><br><span class="line">  var b = a.value.split(&quot;.&quot;)[0];</span><br><span class="line">  a0d[b].forEach(function (c, d) &#123;</span><br><span class="line">    var e = document.getElementById(&quot;caption&quot; + (d + 1));</span><br><span class="line">    e.hidden = false;</span><br><span class="line">    e.style.top = a0d[b][d][0];</span><br><span class="line">    e.style.left = a0d[b][d][1];</span><br><span class="line">    e.textContent = a0c[Math.floor(Math.random() * (a0c.length - 1))];</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">a0f();</span><br><span class="line">const a0g = document.getElementById(&quot;meme-image&quot;);</span><br><span class="line">const a0h = document.getElementById(&quot;meme-container&quot;);</span><br><span class="line">const a0i = document.getElementById(&quot;remake&quot;);</span><br><span class="line">const a0j = document.getElementById(&quot;meme-template&quot;);</span><br><span class="line">a0g.src = a0e[a0j.value];</span><br><span class="line">a0j.addEventListener(&quot;change&quot;, () =&gt; &#123;</span><br><span class="line">  a0g.src = a0e[a0j.value];</span><br><span class="line">  a0g.alt = a0j.value;</span><br><span class="line">  a0f();</span><br><span class="line">&#125;);</span><br><span class="line">a0i.addEventListener(&quot;click&quot;, () =&gt; &#123;</span><br><span class="line">  a0f();</span><br><span class="line">&#125;);</span><br><span class="line">function a0k() &#123;</span><br><span class="line">  const a = a0g.alt.split(&quot;/&quot;).pop();</span><br><span class="line">  if (a !== Object.keys(a0e)[5]) &#123;</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  const b = a0l.textContent;</span><br><span class="line">  const c = a0m.textContent;</span><br><span class="line">  const d = a0n.textContent;</span><br><span class="line">  if (a0c.indexOf(b) == 14 &amp;&amp; a0c.indexOf(c) == a0c.length - 1 &amp;&amp; a0c.indexOf(d) == 22) &#123;</span><br><span class="line">    var e = new Date().getTime();</span><br><span class="line">    while (new Date().getTime() &lt; e + 3000) &#123;&#125;</span><br><span class="line">    var f = d[3] + &quot;h&quot; + a[10] + b[2] + a[3] + c[5] + c[c.length - 1] + &quot;5&quot; + a[3] + &quot;4&quot; + a[3] + c[2] + c[4] + c[3] + &quot;3&quot; + d[2] + a[3] + &quot;j4&quot; + a0c[1][2] + d[4] + &quot;5&quot; + c[2] + d[5] + &quot;1&quot; + c[11] + &quot;7&quot; + a0c[21][1] + b.replace(&quot; &quot;, &quot;-&quot;) + a[11] + a0c[4].substring(12, 15);</span><br><span class="line">    f = f.toLowerCase();</span><br><span class="line">    alert(atob(&quot;Q29uZ3JhdHVsYXRpb25zISBIZXJlIHlvdSBnbzog&quot;) + f);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">const a0l = document.getElementById(&quot;caption1&quot;);</span><br><span class="line">const a0m = document.getElementById(&quot;caption2&quot;);</span><br><span class="line">const a0n = document.getElementById(&quot;caption3&quot;);</span><br><span class="line">a0l.addEventListener(&quot;keyup&quot;, () =&gt; &#123;</span><br><span class="line">  a0k();</span><br><span class="line">&#125;);</span><br><span class="line">a0m.addEventListener(&quot;keyup&quot;, () =&gt; &#123;</span><br><span class="line">  a0k();</span><br><span class="line">&#125;);</span><br><span class="line">a0n.addEventListener(&quot;keyup&quot;, () =&gt; &#123;</span><br><span class="line">  a0k();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>remake到有三个输入框的，根据条件，三个输入框内分别是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">b = a0c[14] = &quot;FLARE On&quot;</span><br><span class="line">c = a0c[a0c.length - 1] = a0c[25] = &quot;Security Expert&quot;</span><br><span class="line">d = a0c[22] = &quot;Malware&quot;</span><br></pre></td></tr></table></figure>

<p>输入进去，alert出来了</p>
<img src="/2025/02/24/flare-on11_re_by_Flooc/image-20241005163359579.png" class="" title="image-20241005163359579">



<p>这次只做到这了，第一次做这种题，主要还是对Linux系统和linux系统调试工具不是很熟悉，再加上是第一次做这种很像取证的题目，被硬控了很长时间也没做出来。</p>
<p>网上能搜索到很多大佬的WP，看完后也是有很大感悟。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Flooc</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/02/24/flare-on11_re_by_Flooc/">http://example.com/2025/02/24/flare-on11_re_by_Flooc/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">Flooc</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/reverse/">reverse</a><a class="post-meta__tags" href="/tags/ctf/">ctf</a><a class="post-meta__tags" href="/tags/flareon/">flareon</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/02/24/2024%E5%B9%B4%E4%BA%AC%E6%B4%A5%E5%86%80%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%EF%BC%88%E9%A6%96%E5%B1%8A%EF%BC%89by_Flooc/" title="2024年京津冀大学生信息安全网络攻防大赛（首届） writeup"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">2024年京津冀大学生信息安全网络攻防大赛（首届） writeup</div></div><div class="info-2"><div class="info-item-1">2024年京津冀大学生信息安全网络攻防大赛（首届）|by_Floocreverse看图标py打包的exe，解包，反编译  本来想用z3爆破，仔细看了看，a的每两位数就是flag的ascii码。直接打印： 12345678result = 0x28F811AAE094D40A82BE51B5F4BBB6924300A1D9E72C9AA02E19B8A123BD7A9EED4849CEA7F9395CE507E8C9AF284EA74EB436CD9810A3C876C150p = &quot;666C61677B63393461626261652D353263302D346461302D616666312D3838393737303538393563377D666164616477617364617764617764631B&quot;a = 0x666C61677B63393461626261652D353263302D346461302D616666312D383839373730353839356337A7for i in range(len(p) // 2):   ...</div></div></div></a><a class="pagination-related" href="/2025/01/03/hexo%E5%8D%9A%E5%AE%A2%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E9%97%AE%E9%A2%98/" title="hexo博客图片无法显示问题"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">hexo博客图片无法显示问题</div></div><div class="info-2"><div class="info-item-1">最近在搭自己的博客，用的是github+hexo，但是遇到图片无法加载的问题。。记录一下 hexo g后hexo s后博客中的图片无法加载，F12看一下，发现是路径问题，和这篇博客： 1https://blog.csdn.net/m0_43401436/article/details/107191688  前面的问题一致，然后我安装了其他大佬写的这个插件： 1npm install git://github.com/yiyungent/hexo-asset-img.git#main  之后会在node_modules中多出两个文件夹，一个是 hexo-asset-images，另一个是 hexo-asset-img，直接删掉第一个文件夹，保留第二个，这时在typora中正常插入图片如： 1![xxx](path/xxx.jpg)  就可以在编辑时直接预览，而且hexo g时生成的图片路径是对的。 </div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/02/27/ACECTF-2025-WP-by-Flooc/" title="ACECTF 2025 WP by Flooc"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-27</div><div class="info-item-2">ACECTF 2025 WP by Flooc</div></div><div class="info-2"><div class="info-item-1">ACECTF 2025reverseSignificance of Reversing通过winhex观察二进制数据，发现elf文件倒过来了，reverse一下（ 然后就是解密 1234567891011# with open(r&quot;C:\Users\86158\Downloads\Reverseme.png&quot;, &quot;rb&quot;) as p:#     c = p.read()[::-1]# with open(r&quot;C:\Users\86158\Downloads\Reverseme__.png&quot;, &quot;wb&quot;) as f:#     f.write(c)cipher = r&quot;prtr%uLHb0fc=&lt;0c3_Ff0CbGbCdbN&quot;# print(&quot;&quot;.join([chr(((ord(x) - 33) - 14) % 94) for x in cipher]))for x in cipher:    tmp = ((ord(x) - 33) - 14) %...</div></div></div></a><a class="pagination-related" href="/2025/02/24/2024%E5%B9%B4%E4%BA%AC%E6%B4%A5%E5%86%80%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%EF%BC%88%E9%A6%96%E5%B1%8A%EF%BC%89by_Flooc/" title="2024年京津冀大学生信息安全网络攻防大赛（首届） writeup"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-24</div><div class="info-item-2">2024年京津冀大学生信息安全网络攻防大赛（首届） writeup</div></div><div class="info-2"><div class="info-item-1">2024年京津冀大学生信息安全网络攻防大赛（首届）|by_Floocreverse看图标py打包的exe，解包，反编译  本来想用z3爆破，仔细看了看，a的每两位数就是flag的ascii码。直接打印： 12345678result = 0x28F811AAE094D40A82BE51B5F4BBB6924300A1D9E72C9AA02E19B8A123BD7A9EED4849CEA7F9395CE507E8C9AF284EA74EB436CD9810A3C876C150p = &quot;666C61677B63393461626261652D353263302D346461302D616666312D3838393737303538393563377D666164616477617364617764617764631B&quot;a = 0x666C61677B63393461626261652D353263302D346461302D616666312D383839373730353839356337A7for i in range(len(p) // 2):   ...</div></div></div></a><a class="pagination-related" href="/2025/03/08/TPCTF-2025-reverse%E5%A4%8D%E7%8E%B0-by-Flooc/" title="TPCTF 2025 reverse复现 by Flooc"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-08</div><div class="info-item-2">TPCTF 2025 reverse复现 by Flooc</div></div><div class="info-2"><div class="info-item-1">这次比赛依旧是一个人，只做了逆向，虽然一道题也没做出来， chase使用FCEUX运行nes文件，是个这样的游戏：   通过设置分数跳关，分数的数值存货在固定的地址上：0x84，跳到最后给出第一段flag:   接着直接看PPU查看器，发现第三段 flag:   第二段flag在PPU查看器中发现F对应的图块为0x26，所以FLAG这几个字符对应的数据为262C2127，但是要注意的是数字应该看下面而不是上面   1234567891011121314151617181920212223cipher = &quot;262C21270030340ED200262F3200392F35002933000112A4000118302C2139D12ED93DD6202DD3333D00019ABDADAD6D000103B9ADAD6E000103B9ADAD6E0001030D0103000110000100&quot;import binasciicipher = binascii.a2b_hex(cipher)table = &#123;&#125;charac =...</div></div></div></a><a class="pagination-related" href="/2025/03/01/PwnMe-2025-CTF-Writeup/" title="PwnMe 2025 CTF Writeup"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-01</div><div class="info-item-2">PwnMe 2025 CTF Writeup</div></div><div class="info-2"><div class="info-item-1">PWNME 2025 CTF复现（未完）reverseBack to the pastubuntu上爆破种子，时间戳是在2024年5月，范围就大概有了，然后就是与rand()%127异或，这个脚本也比较简单 Mimirev是个编译器，go写的，用来编译.mimi文件，使用goparser.py还原出符号，还有几个无名函数 在main函数中看到：   是vm操作：0 1 2 3 入栈操作4 加载5存储6加7减8除9乘A取模B C 跳转D相等 E不相等F 小于 0x10 小于等于0x11 大于 0x12 大于等于0x13 自增0x14 验证0x15 打印 有一个__OFSUB__，根据搜索得知是使用IDA插件时产生的，用来判断两数相减是否溢出，返回OF值 同时在这段的汇编界面看到两个字符串：   第一个疑似base64编码字符串，第二个疑似操作码，但如何分辨操作码是两位还是一位的？比如开始就是11，那么是两个1操作还是11操作？不懂，后面研究 Flattened...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Flooc</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/FloocX"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/FloocX" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:williamjones8478@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#flaren-on11-re-by-Flooc"><span class="toc-number">1.</span> <span class="toc-text">flaren-on11_re_by_Flooc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-frog"><span class="toc-number">1.1.</span> <span class="toc-text">1-frog</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-checksum"><span class="toc-number">1.2.</span> <span class="toc-text">2-checksum</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-aray"><span class="toc-number">1.3.</span> <span class="toc-text">3-aray</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Meme-Maker-3000"><span class="toc-number">1.4.</span> <span class="toc-text">4-Meme Maker 3000</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/08/TPCTF-2025-reverse%E5%A4%8D%E7%8E%B0-by-Flooc/" title="TPCTF 2025 reverse复现 by Flooc">TPCTF 2025 reverse复现 by Flooc</a><time datetime="2025-03-08T09:40:05.000Z" title="发表于 2025-03-08 17:40:05">2025-03-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/01/PwnMe-2025-CTF-Writeup/" title="PwnMe 2025 CTF Writeup">PwnMe 2025 CTF Writeup</a><time datetime="2025-03-01T03:02:50.000Z" title="发表于 2025-03-01 11:02:50">2025-03-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/27/ACECTF-2025-WP-by-Flooc/" title="ACECTF 2025 WP by Flooc">ACECTF 2025 WP by Flooc</a><time datetime="2025-02-27T06:52:35.000Z" title="发表于 2025-02-27 14:52:35">2025-02-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/24/2024%E5%B9%B4%E4%BA%AC%E6%B4%A5%E5%86%80%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%EF%BC%88%E9%A6%96%E5%B1%8A%EF%BC%89by_Flooc/" title="2024年京津冀大学生信息安全网络攻防大赛（首届） writeup">2024年京津冀大学生信息安全网络攻防大赛（首届） writeup</a><time datetime="2025-02-24T12:49:59.000Z" title="发表于 2025-02-24 20:49:59">2025-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/24/flare-on11_re_by_Flooc/" title="flareon11 writeup">flareon11 writeup</a><time datetime="2025-02-23T23:53:00.000Z" title="发表于 2025-02-24 07:53:00">2025-02-24</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/background.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By Flooc</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>